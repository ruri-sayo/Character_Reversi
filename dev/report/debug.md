# デバッグモード実装検討レポート

## 1. 概要
ユーザーからの要望に基づき、Character_Reversi プロジェクトにおけるデバッグモードの実装可能性と、その具体的な実装方針を調査・検討しました。

**結論:** 全ての要望要件において**実装可能**です。

## 2. 実装仕様検討

### 2.1. デバッグモードへの移行
**要件:** コンソールでデバッグコマンドを入力すると移行。
**実装方針:**
- Vue の `setup` 内で定義したリアクティブな変数 `isDebugMode` を用意します。
- `window` オブジェクトに対して、デバッグモードを有効化する関数（例: `window.enableDebug()` または `window.toggleDebug()`）を露出させます。
- コンソールから `enableDebug()` を実行することで、`isDebugMode` を `true` に変更します。

### 2.2. UI表示
**要件:** 画面のわかる箇所に「デバッグモード中」と表示。
**実装方針:**
- HTML (`index.html`) に、`v-if="isDebugMode"` で制御される目立つ表示（赤帯や画面隅の固定表示など）を追加します。
- 必要であれば、デバッグモード時のみ表示される追加の操作パネルもこの `div` 内に配置可能です。

### 2.3. 確認用盤面のロード
**要件:** `console` からコマンドで特定の盤面をロード可能にする。設定は別ファイル分離。
**実装方針:**
- 設定ファイル `dev/debug/debug.json` を作成します。
- 構造例:
  ```json
  {
    "patterns": [
      {
        "name": "endgame_win",
        "description": "終盤・勝ち確定",
        "turn": 1,
        "board": [[...]]
      },
      {
        "name": "no_moves",
        "description": "打つ手なし",
        "turn": -1,
        "board": [[...]]
      }
    ]
  }
  ```
- `window.loadDebugBoard(patternName)` 関数を実装します。
- この関数は `fetch('dev/debug/debug.json')` を実行し、指定された `name` の盤面データを取得。
- `game.board` を直接書き換え、`syncState()` を呼び出して画面を更新します。

### 2.4. 強制的なコマ色変更
**要件:** Shift+クリックで、コマの色を強制変更（無→白→黒→無...）。
**実装方針:**
- `index.html` の `@click="onPlayerClick(r, c)"` を `@click="onPlayerClick(r, c, $event)"` に変更し、イベントオブジェクトを受け取れるようにします。
- `onPlayerClick` 内部で `if (state.isDebugMode && event.shiftKey)` の判定を追加します。
- 条件合致時、通常の着手ルール（`canPlace` 等）を無視し、該当セルの値を `(current + 1) % 3` のようなロジックで循環させます（実際は -1, 0, 1 なのでマッピング変換が必要）。
- 変更後、`syncState()` で再描画します。

## 3. 実装上の注意点
- **GameCoreの改修:** 基本的には不要ですが、`board` プロパティへの直接アクセスを前提とします。
- **ファイル構成:** 新規ディレクトリ `dev/debug` の作成が必要です。
- **デプロイ:** `dev/` ディレクトリは開発用のため、本番環境に不要な場合は除外設定などを考慮する必要がありますが、現状の構成ではそのまま含まれても大きな害はありません。

## 4. 作業見積もり
- **難易度:** 低
- **作業量:** 小（1〜2時間程度）
- **影響範囲:** `index.html` (Vueロジック含む), 新規JSONファイル作成。既存のゲームロジック(`game_core.js`)への影響はありません。

以上
